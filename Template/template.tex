\documentclass[$if(fontsize)$$fontsize$,$endif$$if(lang)$$babel-lang$,$endif$$if(papersize)$$papersize$paper,$endif$$for(classoption)$$classoption$$sep$,$endfor$]{$documentclass$}
$if(fontfamily)$
\usepackage[$for(fontfamilyoptions)$$fontfamilyoptions$$sep$,$endfor$]{$fontfamily$}
$else$
\usepackage{lmodern}
$endif$
$if(linestretch)$
\usepackage{setspace}
\setstretch{$linestretch$}
$endif$
\usepackage{pifont}
\newcommand{\xmark}{\color{red}\text{\ding{55}}}
\newcommand{\greencheck}{{\color{green}\checkmark}}

\usepackage{amsmath,amssymb,amsfonts, amstext,amsthm}
\usepackage{attachfile}
\usepackage{minted}
\usepackage{listings}
\usepackage{subcaption}
\usepackage{colortbl}
\usepackage{tikz}
\usepackage{awesomebox}
\usepackage{empheq}
\usepackage[many]{tcolorbox}

\newtcbox{\mybox}[1][]{nobeforeafter,math upper,tcbox raise base,
  enhanced,frame hidden,boxrule=0pt,interior style={top color=gray!10!white,
  bottom color=gray!10!white,middle color=gray!20!white},
  fuzzy halo=1pt with white,drop large lifted shadow,#1}

\usepackage{forest}
\usetikzlibrary{matrix,backgrounds,shapes.multipart,positioning,calc,chains,arrows,arrows.meta,decorations.pathmorphing,tikzmark,shadows,trees,mindmap,backgrounds}
\def\checkmark{\tikz\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;} 

% Commands for Highlighting text -- non tikz method
\newcommand{\highlight}[2]{\colorbox{#1!17}{$$\displaystyle #2$$}}
\newcommand{\highlightdark}[2]{\colorbox{#1!47}{$$\displaystyle #2$$}}

% my custom colors for shading
\colorlet{mhpurple}{purple!80}

\usepackage{xpatch}
\usepackage{mathtools, nccmath}
\usepackage{wrapfig}
\usepackage{comment}
\usepackage{tabularx}
\usepackage{csquotes}

% To generate dummy text
\usepackage{blindtext}
\usepackage{xspace}
% Commands for Highlighting text -- non tikz method
\renewcommand{\highlight}[2]{\colorbox{#1!17}{#2}}
\renewcommand{\highlightdark}[2]{\colorbox{#1!47}{#2}}


\usepackage{mathtools}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[$if(fontenc)$$fontenc$$else$T1$endif$]{fontenc}
  \usepackage[utf8]{inputenc}
$if(euro)$
  \usepackage{eurosym}
$endif$
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
$if(euro)$
  \newcommand{\euro}{€}
$endif$
$if(mainfont)$
    \setmainfont[$for(mainfontoptions)$$mainfontoptions$$sep$,$endfor$]{$mainfont$}
$endif$
$if(sansfont)$
    \setsansfont[$for(sansfontoptions)$$sansfontoptions$$sep$,$endfor$]{$sansfont$}
$endif$
$if(monofont)$
    \setmonofont[Mapping=tex-ansi$if(monofontoptions)$,$for(monofontoptions)$$monofontoptions$$sep$,$endfor$$endif$]{$monofont$}
$endif$
$if(mathfont)$
    \setmathfont(Digits,Latin,Greek)[$for(mathfontoptions)$$mathfontoptions$$sep$,$endfor$]{$mathfont$}
$endif$
$if(CJKmainfont)$
    \usepackage{xeCJK}
    \setCJKmainfont[$for(CJKoptions)$$CJKoptions$$sep$,$endfor$]{$CJKmainfont$}
$endif$
\fi

$if(listings)$
\usepackage{listings}
\newcommand{\passthrough}[1]{#1}
$endif$

% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
$if(geometry)$
\usepackage[$for(geometry)$$geometry$$sep$,$endfor$]{geometry}
$endif$
\usepackage{hyperref}
$if(colorlinks)$
\PassOptionsToPackage{usenames,dvipsnames}{color} % color is loaded by hyperref
$endif$
\hypersetup{unicode=true,
$if(title-meta)$
            pdftitle={$title-meta$},
$endif$
$if(author-meta)$
            pdfauthor={$author-meta$},
$endif$
$if(keywords)$
            pdfkeywords={$for(keywords)$$keywords$$sep$; $endfor$},
$endif$
$if(colorlinks)$
            colorlinks=true,
            linkcolor=$if(linkcolor)$$linkcolor$$else$black$endif$,
            citecolor=$if(citecolor)$$citecolor$$else$blue$endif$,
            urlcolor=$if(urlcolor)$$urlcolor$$else$blue$endif$,
$else$
            pdfborder={0 0 0},
$endif$
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
$if(lang)$
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[shorthands=off,$for(babel-otherlangs)$$babel-otherlangs$,$endfor$main=$babel-lang$]{babel}
$if(babel-newcommands)$
  $babel-newcommands$
$endif$
\else
  \usepackage{polyglossia}
  \setmainlanguage[$polyglossia-lang.options$]{$polyglossia-lang.name$}
$for(polyglossia-otherlangs)$
  \setotherlanguage[$polyglossia-otherlangs.options$]{$polyglossia-otherlangs.name$}
$endfor$
\fi
$endif$
$if(natbib)$
\usepackage{natbib}
\bibliographystyle{$if(biblio-style)$$biblio-style$$else$plainnat$endif$}
$endif$
$if(biblatex)$
\usepackage$if(biblio-style)$[style=$biblio-style$]$endif${biblatex}
$if(biblatexoptions)$\ExecuteBibliographyOptions{$for(biblatexoptions)$$biblatexoptions$$sep$,$endfor$}$endif$
$for(bibliography)$
\addbibresource{$bibliography$}
$endfor$
$endif$
$if(listings)$
\usepackage{listings}
$endif$
$if(lhs)$
\lstnewenvironment{code}{\lstset{language=Haskell,basicstyle=\small\ttfamily}}{}
$endif$
$if(highlighting-macros)$
$highlighting-macros$
$endif$
$if(verbatim-in-note)$
\usepackage{fancyvrb}
\VerbatimFootnotes % allows verbatim text in footnotes
$endif$
$if(tables)$
\usepackage{longtable,booktabs}
$endif$

\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator{\nll}{nll}
\newcommand{\likelihood}[1]{\mathcal{L}(#1)}
\newcommand{\partiald}[1]{\frac{\partial}{\partial #1}}
\newcommand{\dpartiald}[2]{\frac{\partial}{\partial #1 #2}}

\usepackage{graphicx,grffile}
\def\shrug{\texttt{\raisebox{0.75em}{\char`\_}\char`\\\char`\_\kern-0.5ex(\kern-0.25ex\raisebox{0.25ex}{\rotatebox{45}{\raisebox{-.75ex}"\kern-1.5ex\rotatebox{-90})}}\kern-0.5ex)\kern-0.5ex\char`\_/\raisebox{0.75em}{\char`\_}}}



\usepackage{ragged2e}
\newcolumntype{P}[1]{>{\RaggedRight\hspace{0pt}}p{#1}}
\newcolumntype{X}[1]{>{\RaggedRight\hspace*{0pt}}p{#1}}
\justifying
\usepackage{tcolorbox}


\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}

\AtBeginEnvironment{minted}{\dontdofcolorbox}
\def\dontdofcolorbox{\renewcommand\fcolorbox[4][]{##4}}
\xpatchcmd{\inputminted}{\minted@fvset}{\minted@fvset\dontdofcolorbox}{}{}
\xpatchcmd{\mintinline}{\minted@fvset}{\minted@fvset\dontdofcolorbox}{}{}
\setminted{
escapeinside=§§
}
\newcommand{\evolv}[1]{\textcolor{OliveGreen}{\underline{#1}}}

\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}

$if(links-as-notes)$
% Make links footnotes instead of hotlinks:
\renewcommand{\href}[2]{#2\footnote{\url{#1}}}
$endif$
$if(strikeout)$
\usepackage[normalem]{ulem}
% avoid problems with \sout in headers with hyperref:
\pdfstringdefDisableCommands{\renewcommand{\sout}{}}
$endif$
$if(indent)$
$else$
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
$endif$
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
$if(numbersections)$
\setcounter{secnumdepth}{5}
$else$
\setcounter{secnumdepth}{0}
$endif$
$if(subparagraph)$
$else$
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
$endif$
$if(dir)$
\ifxetex
  % load bidi as late as possible as it modifies e.g. graphicx
  $if(latex-dir-rtl)$
  \usepackage[RTLdocument]{bidi}
  $else$
  \usepackage{bidi}
  $endif$
\fi
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \TeXXeTstate=1
  \newcommand{\RL}[1]{\beginR #1\endR}
  \newcommand{\LR}[1]{\beginL #1\endL}
  \newenvironment{RTL}{\beginR}{\endR}
  \newenvironment{LTR}{\beginL}{\endL}
\fi
$endif$
$for(header-includes)$
$header-includes$
$endfor$
\usepackage[utf8]{inputenc}
%\usepackage[brazil, portuguese]{babel}

\usetheme{metropolis}
%\usetheme{CambridgeUS}
\usepackage{appendixnumberbeamer}

\usepackage{booktabs}
\usepackage[scale=2]{ccicons}

\usepackage{pgf}
\usepackage{soul}

\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepgfplotslibrary{dateplot}
\usepgfplotslibrary{fillbetween}
\pgfkeys{/pgfplots/legend entry/.code=\addlegendentry{#1}}

\pgfmathdeclarefunction{gauss}{3}{%
  \pgfmathparse{1/(#3*sqrt(2*pi))*exp(-((#1-#2)^2)/(2*#3^2))}%
}
\definecolor{alizarin}{rgb}{0.82, 0.1, 0.26}

\usepackage{xspace}
\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}

\usepackage[overlay]{textpos}
\usepackage[ruled,vlined]{algorithm2e}

\newcommand{\norm}[1]{\left\lVert#1\right\rVert}

\usepackage{xcolor}
\usepackage{cancel}

\definecolor{OliveGreen}{RGB}{128,128,0}
\definecolor{commentgreen}{RGB}{2,112,10}
\definecolor{eminence}{RGB}{108,48,130}
\definecolor{weborange}{RGB}{255,165,0}
\definecolor{frenchplum}{RGB}{129,20,83}
\definecolor{scottred}{RGB}{140,18,5}

\newcommand\hcancel[2][black]{\setbox0=\hbox{#2}%
\rlap{\raisebox{.45\ht0}{\textcolor{#1}{\rule{\wd0}{1pt}}}}#2} 

\lstset{
    basicstyle=\footnotesize\linespread{0.8}\ttfamily, % Default font
    % numbers=left,              % Location of line numbers
    numberstyle=\tiny,          % Style of line numbers
    % stepnumber=2,              % Margin between line numbers
    numbersep=5pt,              % Margin between line numbers and text
    tabsize=2,                  % Size of tabs
    extendedchars=true,
    breaklines=true,            % Lines will be wrapped
    keywordstyle=\color{eminence},
    frame=tb,
    % keywordstyle=[1]\textbf,
    % keywordstyle=[2]\textbf,
    % keywordstyle=[3]\textbf,
    % keywordstyle=[4]\textbf,   \sqrt{\sqrt{}}
    stringstyle=\color{red}\ttfamily, % Color of strings
    showspaces=false,
    showtabs=false,
    xleftmargin=17pt,
    framexleftmargin=17pt,
    framexrightmargin=5pt,
    framexbottommargin=4pt,
    % backgroundcolor=\color{lightgray},
    showstringspaces=false
}

\lstloadlanguages{
	C,
	C++,
	Python,
	Haskell
	}

$if(title)$
\title{$title$$if(thanks)$\thanks{$thanks$}$endif$}
$endif$
$if(subtitle)$
\providecommand{\subtitle}[1]{}
\subtitle{$subtitle$}
$endif$
$if(author)$
\centering
\author{$for(author)$$author$$sep$ \and $endfor$}
$endif$
$if(institute)$
\centering
\institute{$institute$}
$endif$
\date{$date$}

\titlegraphic{
    \centering
    $if(cover)$
    \includegraphics[width=0.7\textwidth]{$cover$}
    $endif$


    \includegraphics[height=1cm,keepaspectratio]{figs/logotipo-ufabc-abaixo.eps}
    \hspace{\dimexpr\paperwidth-5cm-5pt}
    \includegraphics[height=1cm,keepaspectratio]{figs/logo_cmcc.jpg}
}

\makeatletter
\setbeamertemplate{title page}{
  \begin{minipage}[b][\paperheight]{\textwidth}
    \vfill%
    \ifx\inserttitle\@empty\else\usebeamertemplate*{title}\fi
    \ifx\insertsubtitle\@empty\else\usebeamertemplate*{subtitle}\fi
    \usebeamertemplate*{title separator}
    \ifx\beamer@shortauthor\@empty\else\usebeamertemplate*{author}\fi
    \vfill
    \ifx\insertinstitute\@empty\else\usebeamertemplate*{institute}\fi
    \vfill
    \ifx\insertdate\@empty\else\usebeamertemplate*{date}\fi    
    \vfill
    \ifx\inserttitlegraphic\@empty\else\inserttitlegraphic\fi
    \vspace*{0.5cm}
  \end{minipage}
}


%\setbeamertemplate{background}
%     {\includegraphics[width=\paperwidth,height=\paperheight]{figs/bgslide.jpg}}
%\setbeamercolor{frametitle}{parent=structure}

%\setbeamertemplate{frametitle}{%
%  \nointerlineskip%
%  \begin{beamercolorbox}[%
%      wd=\paperwidth,%
%      sep=0pt,%
%      leftskip=\metropolis@frametitle@padding,%
%      rightskip=\metropolis@frametitle@padding,%
%    ]{frametitle}%
%  \metropolis@frametitlestrut@start%
%  \insertframetitle%
%  \nolinebreak%
%  \metropolis@frametitlestrut@end%
%  \hfill
  %\includegraphics[height=5.5ex,keepaspectratio]{figs/logotipo.png}
%  \end{beamercolorbox}%
%}
\definecolor{UniBlue}{RGB}{83,121,170}
\definecolor{ToBe}{RGB}{179,129,56}
\setbeamercolor{frametitle}{fg=white,bg=UniBlue}
\usefonttheme{professionalfonts}
\usefonttheme{serif}
\usepackage{fontspec}
\setmainfont{Liberation Serif}
\setbeamerfont{note page}{family*=pplx,size=\footnotesize} % Palatino for notes


\setbeamercolor{block body}{bg=ToBe!20}

\define@key{beamerframe}{standout}[true]{
    \setbeamercolor{background canvas}{bg=ToBe!20}
}

\setbeamercolor{footline}{fg=white,bg=UniBlue}
\setbeamertemplate{footline}{%
  \begin{beamercolorbox}[wd=\textwidth, sep=1ex]{footline}%
    \hspace{0.3cm}
    \usebeamerfont{page number in head/foot}%
    \usebeamertemplate*{frame footer}
    \hfill%
    \usebeamertemplate*{frame numbering}
  \end{beamercolorbox}%
}

\makeatother

\begin{document}

%\maketitle

%\addtobeamertemplate{frametitle}{}{%
%\begin{textblock*}{1cm}(\dimexpr\paperwidth-2.2cm,0.5cm)%\dimexpr\paperheight-1.2cm)
%\includegraphics[scale=0.2]{figs/logotipo.png}
%\end{textblock*}}


$if(toc)$
\begin{frame}{Topics}
  \setbeamertemplate{section in toc}[sections numbered]
  \tableofcontents[hideallsubsections]
\end{frame}
$endif$


\begin{frame}[noframenumbering,plain]
\begin{tikzpicture}[remember picture,overlay]

    
% Title & Subtitle
\node
[
    below=0.0cm,
    align=center,
    fill=black!10,
    rounded corners,
    inner xsep=0.0pt,
    inner ysep=8pt, 
    minimum width=\paperwidth,
    text width=\paperwidth
] (title) at (current page.north)
{
    \LARGE \parbox{0.9\paperwidth}{\centering $title$}  %\\[5pt]
    %\small \parbox{0.85\paperwidth}{$subtitle$}
};

% Background image
    \node[below=1.5cm] (cover) at (title.south)
    {
        \vspace{0.3cm}
        \parbox{\paperwidth}{\centering{\includegraphics[height=2cm]{figs/cover.png}}}
        \vspace{0.3cm}
    };

% Author 
\node[ below=0.5cm, text width = 0.98\textwidth, align = center] (author) at (cover.south){$for(author/allbutlast)$$author.name$, $endfor$$for(author/last)$$author.name$ $endfor$};

% Author 
\node[ below=0.25cm ](affiliate) at (author.south){\small $institute$};

% Date
\node[below=0.25] (date) at (affiliate.south){\small $date$};

% Logo
\node
[
    below = 0.25cm
] at (date.south)
{
    $for(logo/allbutlast)$
    \includegraphics[height=0.8cm,keepaspectratio]{$logo.name$}
    \hspace{0.5cm}
     $endfor$
    $for(logo/last)$
    \includegraphics[height=0.8cm,keepaspectratio]{$logo.name$}
    \hspace{0.5cm}
     $endfor$
};
\end{tikzpicture}
\end{frame}

$body$

$for(include-after)$
$include-after$

$endfor$

\end{document}
